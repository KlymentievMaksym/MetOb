\documentclass{article}
\input{../../packages.tex}
\hypersetup{colorlinks=true, linkcolor=[RGB]{255, 3, 209}, citecolor={black}}

\graphicspath{ {../Images/} }

\begin{document}
    \begin{titlepage}
        \begin{center}
            \begin{center}
                НАЦІОНАЛЬНИЙ ТЕХНІЧНИЙ УНІВЕРСИТЕТ УКРАЇНИ
                «КИЇВСЬКИЙ ПОЛІТЕХНІЧНИЙ ІНСТИТУТ імені Ігоря СІКОРСЬКОГО»

                Фізико-технічний інститут
            \end{center}
        $\newline$
        \vspace{3.3cm}
        
        {КОМП’ЮТЕРНИЙ ПРАКТИКУМ № 2.\\РОЗВ’ЯЗАННЯ СИСТЕМ ЛІНІЙНИХ АЛГЕБРАЇЧНИХ РІВНЯНЬ (СЛАР) ПРЯМИМИ МЕТОДАМИ}
        \vspace{5cm}
        \begin{flushright}
            Виконав\\студент 3 курсу ФТІ\\групи ФІ-21\\Климентьєв Максим Андрійович
            
            \vspace{1cm}

            Перевірив:\\\underline{\hspace{5cm}}\\Оцінка:\\\underline{\hspace{5cm}}
        \end{flushright}
        \vspace{3cm}
        Київ --- 2025
        \end{center}
    \end{titlepage}
    \newpage

    \pagenumbering{gobble}
    \tableofcontents
    \cleardoublepage
    \pagenumbering{arabic}
    \setcounter{page}{3}

    % Звіт має містити: 
    % - вихідну систему,
    % - результати по кроках приведення до трикутної форми матриці,
    % - кінцевий результат (розв’язок рівняння),
    % - вектор нев’язки,
    % - лістинг програми.
    \newpage
    \section{Вихідна система}
    \begin{tabular}{ |c|c|c| }
        \hline
        Варіант & Матриця системи А & Вектор правої частини b \\ 
        \hline
        10
        &
        $\begin{matrix}
            6.59 & 1.28 & 0.79 & 1.195 & -0.21\\
            0.92 & 3.83 & 1.3 & -1.63 & 1.02\\
            1.15 & -2.46 & 5.77 & 2.1 & 1.483\\
            1.285 & 0.16 & 2.1 & 5.77 & -18\\
            0.69 & -1.68 & -1.217 & 9 & -6
        \end{matrix}$
        &
        $\begin{matrix}
            2.1\\
            0.36\\
            3.89\\
            11.04\\
            -0.27
        \end{matrix}$
        \\ 
        \hline
    \end{tabular}

    \section{Результати по кроках приведення до трикутної форми матриці}
    $$ A =
\left(    \begin{matrix}
        6.59 & 1.28 & 0.79 & 1.195 & -0.21\\
        0 & 3.65130501 & 1.18971168 & -1.79682853 & 1.04931715\\
        0 & -2.68336874 & 5.63213961 & 1.89146434 & 1.51964643\\
        0 & -0.08959029 & 1.94595599 & 5.53698407 & -17.95905159\\
        0 & -1.81402124 & -1.29971624 & 8.8748786 & -5.97801214
    \end{matrix}\right)
    b = 
\left(    \begin{matrix}
        2.1       \\
        0.06682853\\
        3.52353566\\
        10.63051593\\
        -0.4898786
    \end{matrix}\right)
   $$

   $$ A =
\left(   \begin{matrix}
        6.59 & 1.28 & 0.79 & 1.195 & -0.21 \\
        0 & 3.65130501 & 1.18971168 & -1.79682853 & 1.04931715 \\
        0 & 0 & 6.50646677 & 0.5709629 & 2.2907967  \\
        0 & 0 & 1.97514737 & 5.49289616 & -17.93330501 \\
        0 & 0 & -0.70865023 & 7.98218815 & -5.45669617
   \end{matrix}\right)
   b =
\left(   \begin{matrix}
        2.1       \\
        0.06682853\\
        3.5726484 \\
        10.63215567\\
        -0.45667722
    \end{matrix}\right)
  $$

  $$ A =
 \left( \begin{matrix}
        6.59 & 1.28 & 0.79 & 1.195 & -0.21 \\
        0 & 3.65130501 & 1.18971168 & -1.79682853 & 1.04931715 \\
        0 & 0 & 6.50646677 & 0.5709629 & 2.2907967  \\
        0 & 0 & 0 & 5.31957077 & -18.62871486 \\
        0 & 0 & 0 & 8.04437444 & -5.20719461
  \end{matrix}\right)
  b =
\left(  \begin{matrix}
    2.1       \\
    0.06682853\\
    3.5726484 \\
    9.54761819\\
    -0.0675631
\end{matrix}\right)
 $$

 $$ A =
\left( \begin{matrix}
        6.59 & 1.28 & 0.79 & 1.195 & -0.21\\
        0 & 3.65130501 & 1.18971168 & -1.79682853 & 1.04931715\\
        0 & 0 & 6.50646677 & 0.5709629 & 2.2907967 \\
        0 & 0 & 0 & 5.31957077 & -18.62871486\\
        0 & 0 & 0 & 0 & 22.96356651
 \end{matrix}\right)
 b =
\left( \begin{matrix}
    2.1       \\
    0.06682853\\
    3.5726484 \\
    9.54761819\\
    -14.50568583
\end{matrix}\right)
$$

    \section{Кінцевий результат (розв’язок рівняння)}
$$ x = 
\left( \begin{matrix}
    0.32954436\\
    -0.26882477\\
    0.80811347\\
    -0.41729254\\
    -0.63168262
\end{matrix}\right)
$$
    \section{Вектор нев’язки}
$$ r = 
\left( \begin{matrix}
    0.00000000e+00\\
    1.11022302e-16\\
    4.44089210e-16\\
    3.55271368e-15\\
    4.44089210e-16
\end{matrix}\right)
$$

    \section{Лістинг програми}
    \begin{lstlisting}[language=Python, caption=Bisect]
import numpy as np
def solve(A, b):
    x = np.zeros_like(b)
    for col in range(1, A.shape[1]):
        for row in range(col, A.shape[0]):
            zeroiator = (- A[row, col-1]/A[col-1, col-1])
            A[row] = A[row] + A[col-1] * zeroiator
            b[row] = b[row] + b[col-1] * zeroiator
        print(A)
        print(b)

    for col in range(A.shape[1]-1, -1, -1):
        result = 0
        for row in range(A.shape[0]-1, col, -1):
            result += A[col, row] * x[row]
        x[col] = (b[col] - result)/A[col, col]

    return x


A = np.array([
    [6.59, 1.28, 0.79, 1.195, -0.21],
    [0.92, 3.83, 1.3, -1.63, 1.02],
    [1.15, -2.46, 5.77, 2.1, 1.483],
    [1.285, 0.16, 2.1, 5.77, -18],
    [0.69, -1.68, -1.217, 9, -6]
])
A_start = A.copy()
b = np.array([
    [2.1],
    [0.36],
    [3.89],
    [11.04],
    [-0.27]
])
b_start = b.copy()
x = solve(A, b)
print()
print()
print(x)
r = abs(b_start - A_start@x)
print()
print(r)
    \end{lstlisting}
\end{document}